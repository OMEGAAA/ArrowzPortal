<!DOCTYPE html>
<html lang="ja">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FT RESULTS | ARROWZ栃木ポータルサイト</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Oswald:wght@400;500;700&family=Roboto+Mono:wght@400;700&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/animations.css">
</head>

<body>

    <div class="cursor-dot" data-cursor-dot></div>
    <div class="cursor-outline" data-cursor-outline></div>

    <header class="header">
        <div class="logo">
            <a href="index.html">
                <img src="images/arrowz_logo13.png" alt="ARROWZ" class="logo-img">
            </a>
        </div>
        <nav class="nav">
            <ul class="nav-list">
                <li class="nav-item"><a href="index.html" class="nav-link" data-hover="ホーム">ホーム</a></li>
                <li class="nav-item"><a href="news.html" class="nav-link" data-hover="お知らせ">お知らせ</a></li>
                <li class="nav-item"><a href="homework.html" class="nav-link" data-hover="宿題動画">宿題動画</a></li>
                <li class="nav-item"><a href="results.html" class="nav-link" data-hover="FT結果">FT結果</a></li>
                <li class="nav-item"><a href="weekly.html" class="nav-link" data-hover="今週のアローズジム">今週のアローズジム</a></li>
            </ul>
        </nav>
        <div class="menu-toggle">
            <div class="bar"></div>
            <div class="bar"></div>
        </div>
    </header>

    <main>
        <!-- Section 1: This Month's Results -->
        <section class="section">
            <div class="container">
                <h2 class="section-title" data-text="今月の結果">今月の結果</h2>
                <div class="result-summary-card">
                    <div class="summary-header">
                        <span class="summary-date" id="res-date">—</span>
                        <span class="summary-label">COMMENT</span>
                    </div>
                    <div class="summary-body">
                        <!-- <div class="score-display"> Removed Average Score -->
                        <p class="summary-comment" style="font-size: 1.2rem; line-height: 1.6; margin-bottom: 1rem;">
                            今月は全体的にスピードが向上しました！
                        </p>
                        <p class="summary-text" id="res-summary">ランキングデータを読み込み中…</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- Section 2: Personal Data -->
        <!-- Section 2: Personal Data -->
        <section class="section">
            <div class="container">
                <h2 class="section-title" data-text="個人データ">個人データ</h2>
                <div class="result-personal-wrapper">
                    <div class="personal-data-card">
                        <div class="login-prompt">
                            <p>個人の詳細データを確認するにはログインしてください。</p>
                            <a href="https://drive.google.com/drive/folders/1eiqbKnCbcv80iE7pFOWnwh1apFcUn_vg?usp=sharing"
                                class="btn-primary" style="text-decoration: none; display: inline-block;">LOGIN / MY
                                PAGE
                                <span class="arrow">→</span></a>
                        </div>
                        <!-- Sample visualization background -->
                        <div class="data-viz-bg"></div>
                    </div>
                    <div class="personal-data-image-container">
                        <img src="images/ft_summary_img.png" alt="フィールドテスト結果まとめ" class="summary-img">
                        <p class="summary-caption">フィールドテスト結果まとめ（2026.01.09更新）</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- Section 3: Ranking Table -->
        <section class="section">
            <div class="container">
                <h2 class="section-title" data-text="ランキング">ランキング表</h2>
                <div class="ranking-wrapper">
                    <table class="ranking-table">
                        <thead>
                            <tr>
                                <th>RANK</th>
                                <th>NAME</th>
                                <th>CLASS</th>
                                <th>最高速度</th>
                            </tr>
                        </thead>
                        <tbody id="res-ranking-body"></tbody>
                    </table>
                </div>
                <div class="ranking-footer" style="text-align: center; margin-top: 2rem;">
                    <a href="ranking.html" class="btn-primary"
                        style="text-decoration: none; display: inline-block;">VIEW FULL RANKING <span
                            class="arrow">→</span></a>
                </div>
            </div>
        </section>
    </main>

    <footer class="footer">
        <div class="container footer-content">
            <div class="footer-logo"><a
                    href="https://www.sports-science.co.jp/facility/tochigi/?utm_source=ig&utm_medium=social&utm_content=link_in_bio&fbclid=PAZXh0bgNhZW0CMTEAc3J0YwZhcHBfaWQMMjU2MjgxMDQwNTU4AAGnA0qM_hiKRR2bV2FCewG_8KCj-2P1WLxekZuYS_LkNXkv36WaadTpXSyxyW0_aem_r9qsksJPKb-rXfjTjhn6wQ"
                    target="_blank" style="text-decoration: none; color: inherit;">ARROWZ</a><span class="dot">.</span>
            </div>
            <div class="footer-links">
                <a href="https://line.me/R/ti/p/@322ctrff?ts=03251611&oat_content=url" target="_blank">LINE</a>
                <a href="https://www.instagram.com/arrowz_tochigi/" target="_blank">INSTAGRAM</a>
                <a href="https://www.youtube.com/@%E3%82%A2%E3%83%AD%E3%83%BC%E3%82%BA%E6%A0%83%E6%9C%A8"
                    target="_blank">YOUTUBE</a>
            </div>
            <div class="footer-bottom">
                <p>&copy; 2026 ARROWZ. ALL RIGHTS RESERVED.</p>
            </div>
        </div>
    </footer>

    <script src="js/ranking_data.js"></script>
    <script src="js/main.js"></script>
    <script>
        (function () {
            if (!window.RANKING_DATA) return;

            // Sort by vmax descending
            const sorted = [...window.RANKING_DATA].sort((a, b) => {
                const valA = (a.scores && a.scores.vmax) || 0;
                const valB = (b.scores && b.scores.vmax) || 0;
                return valB - valA;
            });

            // Summary card
            const avgEl = document.getElementById('res-avg');
            const dateEl = document.getElementById('res-date');
            const summaryEl = document.getElementById('res-summary');

            // Determine the date to display (use the first record's test_date if available)
            let resultDate = new Date();
            if (sorted.length > 0 && sorted[0].test_date) {
                const d = new Date(sorted[0].test_date);
                if (!isNaN(d.getTime())) {
                    resultDate = d;
                }
            }

            // if (avgEl && sorted.length) {
            //    const avg = sorted.reduce((s, d) => s + ((d.scores && d.scores.vmax) || 0), 0) / sorted.length;
            //    avgEl.textContent = avg.toFixed(1);
            // }
            if (dateEl) {
                dateEl.textContent = resultDate.getFullYear() + '.' + String(resultDate.getMonth() + 1).padStart(2, '0');
            }
            if (summaryEl && sorted.length) {
                summaryEl.textContent = `${resultDate.getMonth() + 1}月分の結果を反映しました。登録人数は${sorted.length}人です。`;
            }

            // Ranking table (all students)
            const tbody = document.getElementById('res-ranking-body');
            if (tbody) {
                sorted.forEach((d, i) => {
                    const tr = document.createElement('tr');
                    if (i < 3) tr.className = 'rank-' + (i + 1);
                    const scoreVal = (d.scores && d.scores.vmax) || 0;
                    tr.innerHTML = `<td class="rank-num">${String(i + 1).padStart(2, '0')}</td><td class="rank-name">${d.name}</td><td>${d.class || d.category || ''}</td><td class="rank-score">${scoreVal.toFixed(1)}</td>`;
                    tbody.appendChild(tr);
                });
            }
        })();
    </script>
</body>

</html>