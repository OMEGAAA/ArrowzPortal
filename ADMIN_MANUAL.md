# サイト更新マニュアル (Admin Manual)

このマニュアルでは、ARROWZウェブサイトの主要な更新作業「お知らせ」「ランキング」「今週のメニュー」の更新方法について説明します。

---

## 1. お知らせの更新 (News)
管理画面 (`news_admin.html`) を使用して更新します。

6. **ファイルを更新**:
    - ダウンロードした場合: `js/news_data.js` を上書き保存します。
    - コピーした場合: `js/news_data.js` を開き、中身を全て消して貼り付けます。
7. **公開**: GitHubに変更をプッシュします。

---

## 2. ランキングの更新 (Ranking)
ランキングデータは、Excelファイル `フィールドテストデータ 毎月更新.xlsm` から作成されます。

### 必要なもの
- `フィールドテストデータ 毎月更新.xlsm` (データ元)
- `extract_full_ranking.py` (変換プログラム)
- Python環境

### 手順
1. **Excelを更新**: `フィールドテストデータ 毎月更新.xlsm` の「データ」シートに最新の測定結果を入力・保存します。
2. **変換プログラムを実行**:
    - コマンドプロンプトまたはターミナルを開きます。
    - プロジェクトのフォルダに移動します。
    - 以下のコマンドを実行します:
      ```bash
      python extract_full_ranking.py
      ```
    - これにより、`js/ranking_data.js` が自動的に更新されます。
3. **確認**: ブラウザでランキングページを開き、データが更新されているか確認します。
4. **公開**: GitHubに変更をプッシュします。

> **Note**: 2026年2月以降、ランキングのデフォルト表示は「最高速度 (km/h)」に変更されました。「トータルスコア」は廃止されています。Pythonスクリプトを実行すると、自動的に最高速度を基準にランキングデータが生成されます。
---

## 3. 今週のメニューの更新 (Weekly)
「今週のメニュー」や「月間テーマ」は `weekly.html` に直接書かれています。

### ファイル場所
`c:\AntigravityAPP\toukou\weekly.html`

### 手順
1. `weekly.html` をテキストエディタで開きます。
2. 該当する箇所を検索して書き換えます。
    - **メニュー**: "THIS WEEK'S MENU" の下の `<p class="weekly-news-desc">` の中身。
    - **テーマ**: "MONTHLY THEME" の下の `<strong>` タグの中身など。
    - **休館日**: "CLOSED DAYS" の下の `<p>` タグの中身。
3. 保存してGitHubにプッシュします。

---

## トラブルシューティング

### Q. 投稿したのに表示が変わらない
A. ブラウザのキャッシュが残っている可能性があります。「スーパーリロード (Ctrl + F5)」を試してください。また、`js/news_data.js` が正しく上書きされているか確認してください。

### Q. 画像が表示されない
A. アップロードした画像が表示されない場合、データが破損している可能性があります。もう一度画像をアップロードし直して、ファイルを書き出してください。
